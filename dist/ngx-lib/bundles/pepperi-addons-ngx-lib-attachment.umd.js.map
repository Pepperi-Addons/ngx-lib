{"version":3,"file":"pepperi-addons-ngx-lib-attachment.umd.js","sources":["../../../projects/ngx-lib/attachment/attachment.component.html","../../../projects/ngx-lib/attachment/attachment.component.ts","../../../projects/ngx-lib/attachment/attachment.module.ts","../../../projects/ngx-lib/attachment/public-api.ts","../../../projects/ngx-lib/attachment/pepperi-addons-ngx-lib-attachment.ts"],"sourcesContent":["<!-- New code -->\r\n<ng-template #pepperiTemplate>\r\n    <files-uploader [key]=\"key\" [src]=\"src\" [label]=\"label\" [required]=\"required\" [disabled]=\"disabled\"\r\n        [xAlignment]=\"xAlignment\" [rowSpan]=\"rowSpan\" [controlType]=\"controlType\" [form]=\"form\"\r\n        [layoutType]=\"layoutType\" [standAlone]=\"standAlone\" (fileChanged)=\"onFileChanged($event)\"\r\n        (elementClicked)=\"onFileClicked($event)\" [acceptedExtensions]=\"acceptAttachmentType\">\r\n    </files-uploader>\r\n</ng-template>\r\n\r\n<ng-template #pepperiReadonlyTemplate>\r\n    <ng-container *ngIf=\"src?.length > 0; then notEmptyBlock; else emptyBlock\"></ng-container>\r\n    <ng-template #notEmptyBlock>\r\n        <div class=\"pepperi-file-container\">\r\n            <a [id]=\"key\" class=\"color-link body-sm pepperi-card-input \" *ngIf=\"src != null\" title=\"{{ src }}\"\r\n                target=\"_blank\" href=\"{{ src }}\">{{ src }}</a>\r\n        </div>\r\n    </ng-template>\r\n    <ng-template #emptyBlock>\r\n        <span>&nbsp;</span>\r\n    </ng-template>\r\n</ng-template>\r\n\r\n<ng-container *ngIf=\"layoutType === LAYOUT_TYPE.PepperiForm\">\r\n    <div class=\"pepperi-file-container\" [ngClass]=\"{ 'one-row': rowSpan == 1, 'stand-alone': standAlone }\">\r\n        <pep-field-title [label]=\"label\" [required]=\"required\" [disabled]=\"disabled\" [xAlignment]=\"xAlignment\"\r\n            [showTitle]=\"showTitle\">\r\n        </pep-field-title>\r\n        <ng-container *ngTemplateOutlet=\"pepperiTemplate\"></ng-container>\r\n    </div>\r\n</ng-container>\r\n\r\n<ng-container *ngIf=\"layoutType === LAYOUT_TYPE.PepperiCard\">\r\n    <ng-container *ngIf=\"false && isActive && !disabled; then selectedBlock; else notSelectedBlock\"></ng-container>\r\n    <ng-template #selectedBlock>\r\n        <div class=\"pepperi-file-container\" [ngClass]=\"{ 'one-row': rowSpan == 1, 'stand-alone': standAlone}\">\r\n            <ng-container *ngTemplateOutlet=\"pepperiTemplate\"></ng-container>\r\n        </div>\r\n    </ng-template>\r\n    <ng-template #notSelectedBlock>\r\n        <ng-container *ngTemplateOutlet=\"pepperiReadonlyTemplate\"></ng-container>\r\n    </ng-template>\r\n</ng-container>\r\n\r\n\r\n<ng-container *ngIf=\"layoutType === LAYOUT_TYPE.PepperiTable\">\r\n    <ng-container *ngIf=\"false && isActive && !disabled; then selectedBlock; else notSelectedBlock\"></ng-container>\r\n    <ng-template #selectedBlock>\r\n        <div class=\"pepperi-file-container one-row\">\r\n            <ng-container *ngTemplateOutlet=\"pepperiTemplate\"></ng-container>\r\n        </div>\r\n    </ng-template>\r\n    <ng-template #notSelectedBlock>\r\n        <ng-container *ngTemplateOutlet=\"pepperiReadonlyTemplate\"></ng-container>\r\n    </ng-template>\r\n</ng-container>\r\n","import { Component, OnInit, OnChanges, Input, Output, EventEmitter, ChangeDetectionStrategy, ElementRef, Renderer2, OnDestroy } from '@angular/core';\r\nimport { FormGroup } from '@angular/forms';\r\nimport { FileService, CustomizationService, LAYOUT_TYPE } from '@pepperi-addons/ngx-lib';\r\n\r\n@Component({\r\n    selector: 'pep-attachment',\r\n    templateUrl: './attachment.component.html',\r\n    styleUrls: ['./attachment.component.scss'],\r\n    changeDetection: ChangeDetectionStrategy.OnPush,\r\n})\r\nexport class PepperiAttachmentComponent implements OnInit, OnChanges, OnDestroy {\r\n    @Input() key = '';\r\n    @Input() src = '';\r\n    @Input() label = '';\r\n    @Input() required = false;\r\n    @Input() disabled = false;\r\n    @Input() readonly = false;\r\n    @Input() xAlignment = '0';\r\n    @Input() rowSpan = 1;\r\n\r\n    controlType = 'attachment';\r\n\r\n    @Input() form: FormGroup = null;\r\n    @Input() showTitle = true;\r\n    @Input() layoutType: LAYOUT_TYPE = LAYOUT_TYPE.PepperiForm;\r\n    @Input() isActive = false;\r\n\r\n    @Output() valueChanged: EventEmitter<any> = new EventEmitter<any>();\r\n    @Output() elementClicked: EventEmitter<any> = new EventEmitter<any>();\r\n\r\n    LAYOUT_TYPE = LAYOUT_TYPE;\r\n    fieldHeight = '';\r\n    standAlone = false;\r\n    dataURI = null;\r\n\r\n    acceptAttachmentType =\r\n        'application/pdf,application/json,text/csv,text/csv-schema,application/msword,application/vnd.ms-excel,text/plain,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.openxmlformats-officedocument.wordprocessingml.document,image/bmp,image/jpg, image/jpeg, image/png, image/tif, image/tiff, txt, json';\r\n\r\n    constructor(\r\n        private customizationService: CustomizationService,\r\n        private renderer: Renderer2,\r\n        public element: ElementRef,\r\n        private fileService: FileService) { }\r\n\r\n    ngOnDestroy(): void {\r\n        if (this.elementClicked) {\r\n            this.elementClicked.unsubscribe();\r\n        }\r\n\r\n        if (this.valueChanged) {\r\n            this.valueChanged.unsubscribe();\r\n        }\r\n    }\r\n\r\n    ngOnInit(): void {\r\n        if (this.form === null) {\r\n            this.standAlone = true;\r\n            this.form = this.customizationService.getDefaultFromGroup(this.key, this.src, this.required, this.readonly, this.disabled);\r\n\r\n            this.renderer.addClass(this.element.nativeElement, CustomizationService.STAND_ALONE_FIELD_CLASS_NAME);\r\n        }\r\n\r\n        this.fieldHeight = this.customizationService.calculateFieldHeight(this.layoutType, this.rowSpan, this.standAlone);\r\n    }\r\n\r\n    ngOnChanges(changes: any): void {\r\n        if (changes.src && changes.src.currentValue.length > 0) {\r\n            // Empty dataURI if there is change in the src.\r\n            this.dataURI = null;\r\n        }\r\n    }\r\n\r\n    onFileChanged(value: any): void {\r\n        this.dataURI = value.length > 0 ? JSON.parse(value) : null;\r\n        this.src = this.dataURI ? this.dataURI.fileStr : '';\r\n        this.customizationService.updateFormFieldValue(this.form, this.key, this.dataURI ? this.dataURI.fileExt : '');\r\n        this.valueChanged.emit({ apiName: this.key, value, controlType: this.controlType });\r\n    }\r\n\r\n    onFileClicked(event): void {\r\n        if (this.dataURI != null) {\r\n            const fileStrArr = this.dataURI.fileStr.split(';');\r\n            if (fileStrArr.length === 2) {\r\n                const win = window.open('', '_blank');\r\n                const contentType = fileStrArr[0].split(':')[1];\r\n                const base64 = fileStrArr[1].split(',')[1];\r\n                const blob = this.fileService.convertFromb64toBlob(base64, contentType);\r\n                const url = URL.createObjectURL(blob);\r\n                win.location.href = url;\r\n            }\r\n        } else {\r\n            if (this.fileService.isValidUrl(this.src)) {\r\n                const win = window.open('', '_blank');\r\n                win.location.href = this.src;\r\n            }\r\n        }\r\n\r\n        this.elementClicked.emit({ apiName: this.key, eventWhich: event.which });\r\n    }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { ReactiveFormsModule, FormsModule } from '@angular/forms';\r\n\r\nimport { MatCommonModule } from '@angular/material/core';\r\nimport { MatFormFieldModule } from '@angular/material/form-field';\r\n\r\nimport { PepperiModule } from '@pepperi-addons/ngx-lib';\r\nimport { PepperiFieldTitleModule } from '@pepperi-addons/ngx-lib/field-title';\r\nimport { PepperiFilesUploaderModule } from '@pepperi-addons/ngx-lib/files-uploader';\r\n\r\nimport { PepperiAttachmentComponent } from './attachment.component';\r\n\r\n@NgModule({\r\n    imports: [\r\n        CommonModule,\r\n        ReactiveFormsModule,\r\n        FormsModule,\r\n        // Material modules\r\n        MatCommonModule,\r\n        MatFormFieldModule,\r\n        // Pepperi modules\r\n        PepperiModule,\r\n        PepperiFieldTitleModule,\r\n        PepperiFilesUploaderModule\r\n    ],\r\n    exports: [ PepperiAttachmentComponent ],\r\n    declarations: [ PepperiAttachmentComponent ],\r\n})\r\nexport class PepperiAttachmentModule {}\r\n","/*\r\n * Public API Surface of ngx-lib/attachment\r\n */\r\nexport * from './attachment.module';\r\nexport * from './attachment.component';\r\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"],"names":["i0.ɵɵelementStart","i0.ɵɵlistener","i0.ɵɵelementEnd","i0.ɵɵproperty","i0.ɵɵelementContainer","i0.ɵɵtext","i0.ɵɵpropertyInterpolate","i0.ɵɵadvance","i0.ɵɵtextInterpolate","i0.ɵɵtemplate","i0.ɵɵelementContainerStart","i0.ɵɵelement","i0.ɵɵelementContainerEnd","LAYOUT_TYPE","EventEmitter","CustomizationService","Component","ChangeDetectionStrategy","Input","Output","CommonModule","ReactiveFormsModule","FormsModule","MatCommonModule","MatFormFieldModule","PepperiModule","PepperiFieldTitleModule","PepperiFilesUploaderModule","NgModule"],"mappings":"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"}